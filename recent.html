<style>
  .off-canvas--main-content .divider.bottom-margin {
    position: relative;
  }
  .off-canvas--main-content .divider.bottom-margin:after {
    /* background: #ebebeb;*/
    background: red;
    height: 1px;
    width: 100%;
    position: absolute;
    left: 0;
  }
  .cc-rv-57464782 {
    display: none;
    opacity: 0;
    margin: 0 auto 0px;
    max-width: 320px;
    padding-bottom: 45px;
    @media screen and (min-width: 599px) {
      height: 690px;
    }
    .cc-rv-recentview {
      background: #fff;
      width: 100%;
      transition: 0.6s;
      z-index: 9;
      display: flex;
      flex-wrap: wrap;
      @media screen and (min-width: 599px) {
        transform: scale(1.5) translateY(70px);
      }
      .cc-rv-bottom-sec {
        text-align: center;
        padding-top: 40px;
        padding-bottom: 40px;
        width: 100%;
        span {
          font-weight: 600;
          font-size: 19px;
          letter-spacing: 1px;
          color: #000;
          text-transform: uppercase;
          @media screen and (min-width: 599px) {
            font-size: 16px;
          }
        }
        img {
          width: 15px;
        }
      }
      .cc-rv-viewed-content {
        background: #ffffff;
        width: 100%;
        padding: 0px;
        margin: 0px;
        font-size: 0px;
        display: flex;
        .cc-rv-products {
          margin: 0 auto -5px;
          position: relative;
          width: 95%;
          .cc-rv-prev {
            position: absolute;
            top: 50%;
            left: -30px;
            cursor: pointer;
            display: none;
            @media screen and (max-width: 330px) {
              left: -7px;
            }
            @media screen and (min-width: 599px) {
              left: -45px;
            }
            a {
              width: 15px;
              position: relative;
              left: 0px;
              top: 10px;
            }
            img {
              width: 15px;
            }
            img.cc-rv-last {
              display: none;
            }
          }
          .cc-rv-next {
            position: absolute;
            top: 50%;
            right: -30px;
            cursor: pointer;
            display: none;
            @media screen and (max-width: 330px) {
              right: -7px;
            }
            @media screen and (min-width: 599px) {
              right: -45px;
            }
            img {
              width: 15px;
              position: relative;
              left: 0px;
              top: 0px;
            }
            img.cc-rv-last {
              display: none;
            }
          }
          .cc-rv-next.cc-wl-slide-inactive {
            img.cc-rv-last {
              display: block;
              opacity: 0.5;
              pointer-events: none;
            }
            img.cc-rv-first {
              display: none;
            }
          }
          .cc-rv-prev.cc-wl-slide-inactive {
            img.cc-rv-last {
              display: block;
              opacity: 0.5;
              pointer-events: none;
            }
            img.cc-rv-first {
              display: none;
            }
          }
          .cc-rv-product-items div {
            margin: 0 auto;
          }
          .cc-rv-product-items {
            .cc-rvp-product {
              margin: 0 auto;
              padding: 0 5px;
              @media screen and (min-width: 599px) {
                padding: 0 12px;
              }
              .cc-rvp-product-image {
                display: block;
                height: 143px;
              }
              img {
                margin: 0 auto;
                display: block;
                padding-bottom: 5px;
                max-height: 143px;
                height: auto;
              }
              .cc-rvp-earth-new {
                min-height: 100px;
              }
              .cc-rvp-product-name {
                height: 90px;
                a {
                  display: block;
                  text-align: center;
                  color: #111;
                  font-size: 14px;
                  font-weight: 500;
                  line-height: 1.5;
                  margin: 0 auto;
                  padding: 0.5em 0;
                  min-height: 72px;
                  @media screen and (min-width: 599px) {
                    font-size: 12px;
                  }
                }
              }
              .cc-rvp-product-price {
                color: #00aeef;
                font-size: 18px;
                font-weight: 600;
                text-align: center;
                @media screen and (min-width: 599px) {
                  font-size: 16px;
                }
              }
              .cc-rvp-view-product {
                a {
                  display: block;
                  background: #00aeef;
                  color: #fff;
                  width: 113px;
                  text-transform: uppercase;
                  margin: auto;
                  padding: 10px 0;
                  font-size: 10px;
                  text-decoration: none;
                  text-align: center;
                  font-weight: 500;
                  margin-top: 10px;
                  border-radius: 0;
                  img {
                    display: inline-block;
                    max-height: 20px;
                  }
                }
              }
            }
          }
        }
      }
    }
    a:hover {
      text-decoration: none;
    }
  }
</style>
<cc-snippet name="recent">
  <div class="cc-rv-57464782">
    <div class="cc-rv-recentview">
      <div class="cc-rv-bottom-sec">
        <span>Recently Viewed </span>
      </div>
      <div class="cc-rv-viewed-content">
        <div class="cc-rv-products">
          <div class="cc-rv-prev">
            <img class="cc-rv-first" src="https://cdn.convertcart.com/uploads/9c072302.svg" alt="RecentlyViewed" />
            <img class="cc-rv-last" src="https://cdn.convertcart.com/uploads/9c072302.svg" alt="RecentlyViewed" />
          </div>
          <div class="cc-rv-next">
            <img class="cc-rv-first" src="https://cdn.convertcart.com/uploads/55785ebb.svg" alt="RecentlyViewed" />
            <img class="cc-rv-last" src="https://cdn.convertcart.com/uploads/55785ebb.svg" alt="RecentlyViewed" />
          </div>            
          <div class="cc-rv-product-items">
          </div>     
        </div>
      </div>
    </div>
  </div>
</cc-snippet>
<cc-snippet name="product">
  <div class="cc-rvp-product">
    <div class="cc-rvp-product-inner">
      <a class="cc-rvp-product-image" href="#">
        <img alt="RecentlyViewed" />
      </a>
      <div class="cc-rvp-earth-new">
      <div class="cc-rvp-product-name"><a href=""></a></div>
      <div class="cc-rvp-product-price">$<span></span></div>
      </div>
      <div class="cc-rvp-view-product">
        <a class="cc-rvp-link" href="#">
          View Product
        </a>
      </div>
    </div>
  </div>
</cc-snippet>
<script wait-for=".footer">
  var $ = require('zepto');
  const Siema = require('siema');
  let products;
  let ccChange = false;
  let ccExtra = '';
  const currency = window.Currency.currentCurrency;
  const priceRate = window.Currency.rates[currency];
  // console.log(priceRate);
  // console.log(currency);
  var ccObjwidth = $(window).width();
  const ccObj = $('.cc-rv-viewed-content');
  let productItems;
  const { ctx, snippets } = campaign;
  ctx.ccart('get', 'productsViewed', (iproducts) => {
    products = iproducts.slice(-12) || [];
    // console.log(products);
    function loadCampaign() {
      if (products.length > 1) {
        $('.cc-rv-57464782').show();
        $('.cc-rv-57464782').css('opacity', '1');
      }
      $.each(products, (k, val) => {
        const ccObjproduct = $(snippets.product);
        // ccReview(val.url, k);
        ccObjproduct.find('.cc-rvp-product-image img').attr('src', val.image);
        ccObjproduct.find('a').attr('href', val.url);
        if (val.name.length > 50) {
          ccObjproduct.find('.cc-rvp-product-name a').text(val.name.substr(0, 50) + '...');
        } else {
          ccObjproduct.find('.cc-rvp-product-name a').text(val.name);
        }
        let ccCurrency = '$';
        if (currency == 'GBP') {
          ccCurrency = '£';
          ccExtra = 'GBP';
        } else if (currency == 'EUR') {
          ccCurrency = '€';
          ccExtra = 'EUR';
        } else if (currency == 'JPY') {
          ccCurrency = '¥';
          ccExtra = 'JPY';
        } else if (currency == 'AUD') {
          ccCurrency = '$';
          ccExtra = 'AUD';
        } else if (currency == 'USD') {
          ccCurrency = '$';
          ccExtra = 'USD';
        } else if (currency == 'INR') ccCurrency = 'Rs. ';
        else if (currency == 'CAD') {
          ccCurrency = '$';
          ccExtra = 'CAD';
        }
        else ccCurrency = '$';
        // ccObjproduct.find('.cc-rvp-product-price').text(val.price);
        ccObjproduct.find('.cc-rvp-product-price').html(`${ccCurrency}<span>${val.price}</span> ${ccExtra}`);
        if (currency == 'JPY') {
          ccObjproduct.find('.cc-rvp-product-price').html(`${ccCurrency}<span>${Math.round(val.price)}</span> ${ccExtra}`);
        }
        /* const ccObjtest = parseFloat(val.price).toFixed(2).replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1,');
        let ccCurrency = '$';
        if (currency == 'GBP') {
          ccCurrency = '£';
          ccExtra = 'GBP';
        } else if (currency == 'EUR') {
          ccCurrency = '€';
          ccExtra = 'EUR';
        } else if (currency == 'JPY') {
          ccCurrency = '¥';
          ccExtra = 'JPY';
        } 
        else if (currency == 'AUD') {
          ccCurrency = '$';
          ccExtra = 'AUD';
        }
        else if (currency == 'USD') {
          ccCurrency = '$';
          ccExtra = 'USD';
        }
        else if (currency == 'INR') ccCurrency = 'Rs. ';
        else if (currency == 'CAD') {
          ccCurrency = '$';
          ccExtra = 'CAD';
        }
        else ccCurrency = '$';
        ccObjproduct.find('.cc-rvp-product-price').html(`${ccCurrency}<span>${(ccObjtest / priceRate).toFixed(2)}</span> ${ccExtra}`);
        if (currency == 'JPY') {
          ccObjproduct.find('.cc-rvp-product-price').html(`${ccCurrency}<span>${Math.round((ccObjtest / priceRate))}</span> ${ccExtra}`);
        } */
        ccObjproduct.prependTo('.cc-rv-product-items');
      });
      const ccObjsarrow = $('.cc-rv-viewed-content');
      const ccObjnext = ccObjsarrow.find('.cc-rv-next');
      const ccObjprev = ccObjsarrow.find('.cc-rv-prev');
      function ccSliderCallBack() {
        var ccObjActiveSlide = this.currentSlide + 1;
        var ccObjlastChild = products.length;
        if (ccObjwidth <= 991) {
          if (ccObjActiveSlide == ccObjlastChild - 1) ccObjnext.addClass('cc-wl-slide-inactive');
          else ccObjnext.removeClass('cc-wl-slide-inactive');
        } else {
        if (ccObjActiveSlide == ccObjlastChild - 1) ccObjnext.addClass('cc-wl-slide-inactive');
          else ccObjnext.removeClass('cc-wl-slide-inactive');
        }
        if (ccObjActiveSlide == 1) ccObjprev.addClass('cc-wl-slide-inactive');
        else ccObjprev.removeClass('cc-wl-slide-inactive');
      }
      const slider = new Siema({
        selector: $('.cc-rv-product-items').get(0),
        loop: false,
        draggable: true,
        multipleDrag: true,
        perPage: {
          300: 2,
        },
        onInit: ccSliderCallBack,
        onChange: ccSliderCallBack,
      });
      productItems = $('.cc-rv-product-items .cc-rvp-product').length;
      ccObj.find('.cc-indicators-list li:first-child').addClass('cc-indiactive');
      if (products.length > 1) {
        $('.cc-rv-57464782').css('opacity', '1');
        $('.cc-rv-57464782').show();
      }
      const pitems = products.length;
      if (ccObjwidth < 991) {
        if (pitems > 2) {
          ccObjnext.show();
          ccObjprev.show();
        }
      } else {
      if (pitems > 2) {
          ccObjnext.show();
          ccObjprev.show();
        }
      }
      ccObjnext.on('click', () => {
        slider.next();
        campaign.trigger('Clicked.next');
      });
      ccObjprev.on('click', () => {
        slider.prev();
        campaign.trigger('Clicked.previous');
      });
      ccObjsarrow.find('.cc-rv-product-items .cc-rvp-product').each(function () {
        $(this).find('.cc-rvp-product-image').on('click', function () {
          campaign.trigger('clicked.product image');
        });
        $(this).find('.cc-rvp-product-name').on('click', function () {
          campaign.trigger('clicked.product title');
        });
        $(this).find('.cc-rvp-view-product').on('click', function () {
          const cval = $(this).text();
          campaign.trigger('Clicked.' + cval);
        });
      });
    }
    let cTimer;
    function cccheck() {
      let isExist = 0;
      if ($('.page-collection').length) {
        $('#shopify-section-footer').prepend(campaign.snippets.recent);
        isExist = 1;
      } else {
        $('#shopify-section-footer').prepend(campaign.snippets.recent);
        isExist = 1;
      }
      if (isExist == 1) {
        loadCampaign();
        clearInterval(cTimer);
      }
    }
    cTimer = setInterval(cccheck, 500);
  });
  $('#addtocartbutton').on('click', () => {
    campaign.trigger('clicked.add to cart');
  });
</script>